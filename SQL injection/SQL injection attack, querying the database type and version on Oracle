Lab: SQL injection attack, querying the database type and version on Oracle

üìù Descrizione

Questo laboratorio di PortSwigger presenta una vulnerabilit√† di **SQL Injection** nel filtro delle categorie di prodotto.  
L‚Äôobiettivo del lab √® sfruttare questa vulnerabilit√† per eseguire una **UNION-based SQL Injection** e visualizzare la **stringa di versione del database Oracle**.

> üí° Suggerimento: Nei database Oracle ogni query `SELECT` deve contenere una clausola `FROM`, anche nelle UNION.  
> Oracle fornisce una tabella speciale chiamata `dual` che pu√≤ essere utilizzata per questo scopo.  
Esempio:  `UNION SELECT 'abc' FROM dual`

---

‚öôÔ∏è Passaggi Eseguiti

1. Ho aperto il sito vulnerabile e navigato nel filtro **product category**.
2. Ho avviato **Burp Suite** in modalit√† proxy e intercettato la richiesta HTTP generata dal filtro categoria.
3. Ho individuato il parametro vulnerabile `category` e testato una semplice **SQL Injection di tipo UNION** per determinare il numero di colonne e il tipo di dati.
4. Dopo aver verificato che la query accetta due colonne di tipo testo, ho modificato il payload per recuperare la versione del database Oracle.

---

üß† Ragionamento Tecnico

- Una **UNION-based SQL Injection** consente di combinare i risultati di pi√π query `SELECT` in un'unica risposta.
- Per Oracle, √® obbligatorio specificare una tabella anche quando si usa `UNION SELECT`, ed √® per questo che si usa la tabella speciale `dual`.
- Il primo step consiste nel capire **quante colonne** sono restituite dalla query originale.

Per farlo, si pu√≤ testare un payload come:

    ' UNION SELECT 'abc','def' FROM dual--
    
Se la pagina carica correttamente senza errori, significa che la query sottostante restituisce due colonne, entrambe compatibili con dati di tipo stringa.
Una volta stabilito il numero e tipo di colonne, si pu√≤ costruire un payload per interrogare la **vista `v$version`**, che contiene informazioni sulla versione del database Oracle.

---

‚úÖ Soluzione Finale

üîê Payload usato:
' UNION SELECT BANNER, NULL FROM v$version--

- `BANNER` √® una colonna della vista `v$version` che contiene stringhe con le informazioni sulla versione di Oracle.
- La seconda colonna √® riempita con `NULL` per rispettare la struttura a due colonne.
